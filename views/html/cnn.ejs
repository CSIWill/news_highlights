<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNN</title>
    <link rel="stylesheet" href="../../public/css/stylesheet.css">
    <link rel="shortcut icon" href="../../public/media/picture/Picture1.svg" type="image/x-icon">
</head>

<body>
    <header>
        <nav>
            <button onclick="window.location.href = '/';">My Home Page</button>
            <button onclick="window.location.href = '/login';">Login</button>
            <button onclick="window.location.href = '/settings';">Settings</button>
        </nav>
    </header>
    <main>
        <h1>CNN</h1>
        <section>
            <h2>Latest World News</h2>
            <div class="video">
                <figure>
                    <iframe width="640" height="360"
                        src="https://www.youtube.com/embed/videoseries?list=PL6XRrncXkMaW5p7muaR2s2IqjouQh4jqS"
                        title="YouTube video player" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>Video File Not supported by your browser.</iframe>
                    <figcaption>CNN World News Youtube Playlist</figcaption>
                </figure>
            </div>
            <div>
                <h2>Topics</h2>
                <form>
                    <ul class="setting_check">
                        <li>
                            <label for="select_current_events">Current Events</label>
                            <input type="checkbox" id="select_current_events">
                        </li>
                        <li>
                            <label for="select_technology">Technology</label>
                            <input type="checkbox" id="select_technology">
                        </li>
                        <li>
                            <label for="select_financial">Financial</label>
                            <input type="checkbox" id="select_financial">
                        </li>
                        <input class="btn" type="submit" value="Submit">
                    </ul>
                </form>
            </div>
            <div class="text">
                <h2>News Feed</h2>
                <div class="current_events">
                    <h3>Current Events</h3>
                    <a href="https://us.cnn.com/?refresh=1" aria-label="CNN Trending News"> More Current Events</a>
                    <ul id="current_events"></ul>
                </div>
            </div>
        </section>
    </main>

    <footer>
        &copy;2021, William Eng
        <br>
        Contact Us
        <address>
            <a id="email" href="mailto:weng2@oakland.edu">Email</a>
        </address>
    </footer>
</body>
<script defer>
    const apiKey = '<%= api%>';
    let newsArticlesList;
    const newsList = document.getElementById('current_events');
    const url = `https://newsapi.org/v2/top-headlines?` +
        `sources=cnn&` +
        `apiKey=${apiKey}`;
    const req = new Request(url);
    fetch(req).then((res) => {
        return res.json();
    }).then((data) => {
        newsArticlesList = data;
        console.log(newsArticlesList);
        newsArticlesList.articles.forEach(articles => {
            let newsArticle = document.createElement('li');
            let newsLink = document.createElement('a');
            newsLink.setAttribute('href', articles.url);
            newsLink.setAttribute('target', '_blank');
            newsArticle.textContent = articles.title;
            newsLink.textContent = 'Link';
            newsArticle.appendChild(newsLink);
            newsList.appendChild(newsArticle);
        })
    })
</script>

</html>